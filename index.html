<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>39C3 Power Cycles – Artwork Generator</title>
    <meta
      name="description"
      content="Create custom 39C3 Power Cycles artwork with animated themes, color modes, and export to PNG, SVG, or video formats."
    />

    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://39c3.o1y.de/" />
    <meta property="og:title" content="39C3 Power Cycles – Artwork Generator" />
    <meta
      property="og:description"
      content="Create custom 39C3 Power Cycles artwork with animated themes, color modes, and export to PNG, SVG, or video formats."
    />
    <meta property="og:image" content="https://39c3.o1y.de/og-image.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="39C3 Power Cycles Artwork Generator" />

    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <link rel="stylesheet" href="/styles/index.css" />
  </head>
  <body x-data="appStore" :class="bodyThemeClass">
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
      <defs>
        <symbol
          id="icon-glyph"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="m15 16 2.536-7.328a1.02 1.02 1 0 1 1.928 0L22 16" />
          <path d="M15.697 14h5.606" />
          <path d="m2 16 4.039-9.69a.5.5 0 0 1 .923 0L11 16" />
          <path d="M3.304 13h6.392" />
        </symbol>
        <symbol
          id="icon-typography"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M12 4v16" />
          <path d="M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2" />
          <path d="M9 20h6" />
        </symbol>
        <symbol
          id="icon-animation"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z" />
          <path d="m6.2 5.3 3.1 3.9" />
          <path d="m12.4 3.4 3.1 4" />
          <path d="M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z" />
        </symbol>
        <symbol
          id="icon-download"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M12 15V3" />
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <path d="m7 10 5 5 5-5" />
        </symbol>
        <symbol
          id="icon-share"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M15 3h6v6" />
          <path d="M10 14 21 3" />
          <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
        </symbol>
        <symbol
          id="icon-fullscreen"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="m15 15 6 6" />
          <path d="m15 9 6-6" />
          <path d="M21 16v5h-5" />
          <path d="M21 8V3h-5" />
          <path d="M3 16v5h5" />
          <path d="m3 21 6-6" />
          <path d="M3 8V3h5" />
          <path d="M9 9 3 3" />
        </symbol>
        <symbol
          id="icon-close"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M18 6 6 18" />
          <path d="m6 6 12 12" />
        </symbol>
        <symbol
          id="icon-gallery"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="m22 11-1.296-1.296a2.4 2.4 0 0 0-3.408 0L11 16" />
          <path d="M4 8a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2" />
          <circle cx="13" cy="7" r="1" fill="currentColor" />
          <rect x="8" y="2" width="14" height="14" />
        </symbol>
        <symbol
          id="icon-link"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
          <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
        </symbol>
        <symbol
          id="icon-bookmark"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z" />
        </symbol>
      </defs>
    </svg>

    <div class="header glass-surface" :class="{ 'mobile-collapsed': mobileHeaderCollapsed }">
      <div class="header-row">
        <div class="control-group control-text-input" x-show="showTextInput" x-cloak>
          <label>Text Input</label>
          <div class="text-input-wrapper">
            <input
              type="text"
              maxlength="30"
              x-model="text"
              @input="isTextDirty = true"
              class="control-base"
            />
            <div class="glyph-btn-wrapper desktop-only">
              <button
                type="button"
                class="glyph-picker-btn"
                @click="toggleGlyphPopover"
                :class="{ 'active': glyphPopoverOpen }"
                title="Insert Special Character"
              >
                <svg width="24" height="24"><use href="#icon-glyph" /></svg>
              </button>
              <div
                class="glyph-popover glass-surface"
                x-show="glyphPopoverOpen"
                x-cloak
                x-transition:enter="popover-enter"
                x-transition:enter-start="popover-enter-start"
                x-transition:enter-end="popover-enter-end"
                x-transition:leave="popover-leave"
                x-transition:leave-start="popover-leave-start"
                x-transition:leave-end="popover-leave-end"
                @click.outside="closeGlyphPopover"
              >
                <div class="popover-header">Glyphs</div>
                <div class="glyph-popover-content">
                  <template x-for="category in glyphCategories" :key="category.name">
                    <div class="glyph-category">
                      <div class="glyph-category-name" x-text="category.name"></div>
                      <div class="glyph-grid">
                        <template x-for="glyph in category.glyphs" :key="glyph.unicode">
                          <button
                            type="button"
                            class="glyph-cell"
                            @click="appendToText(glyph.char)"
                            :title="`U+${glyph.unicode.toString(16).toUpperCase().padStart(4, '0')} ${glyph.name}`"
                          >
                            <span
                              class="glyph-char"
                              :class="{ 'glyph-char-wide': glyph.unicode === 0xE002 }"
                              x-text="glyph.char"
                            ></span>
                          </button>
                        </template>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </div>
          </div>
        </div>
        <button class="btn-secondary btn-base mobile-header-toggle" @click="toggleMobileHeader">
          <span class="toggle-icon"></span>
          <span x-text="mobileHeaderCollapsed ? 'Theme & Colors' : 'Hide'"></span>
        </button>
        <div class="controls-collapsible">
          <div class="control-group control-theme">
            <label>Theme</label>
            <select x-model="theme" class="control-base">
              <option value="lines">Nerdy Lines</option>
              <option value="toggle">Toggle</option>
              <option value="toggle39c3Animated">39C3 Toggle Animated</option>
              <option value="toggle39c3Static">39C3 Toggle Static</option>
              <option value="ccc">CCC</option>
              <option value="terminal">Terminal</option>
              <option value="dvd">?</option>
            </select>
          </div>
          <div class="control-group control-theme-option" x-show="showToggleVariantControl" x-cloak>
            <label>Toggle Variant</label>
            <select x-model="toggleVariant" class="control-base">
              <option value="left-filled">Left Filled</option>
              <option value="left-outlined">Left Outlined</option>
              <option value="right-filled">Right Filled</option>
              <option value="right-outlined">Right Outlined</option>
            </select>
          </div>
          <div class="control-group control-theme-option" x-show="showLinesControl" x-cloak>
            <label>Lines</label>
            <div class="control-base-default">
              <input type="range" min="2" max="24" step="1" x-model.number="numLines" />
              <span class="value-display" x-text="linesDisplay"></span>
            </div>
          </div>
          <div class="control-group control-color-mode" x-show="showColorModeControl" x-cloak>
            <label>Color Mode</label>
            <select x-model="colorMode" class="control-base">
              <template x-for="mode in availableColorModes" :key="mode.value">
                <option :value="mode.value" x-text="mode.label"></option>
              </template>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="canvas-container">
      <canvas
        id="canvas"
        class="shadow-accent-glow"
        :class="{ 'cursor-crosshair': mode === 'spotlight' }"
        @click="handleCanvasClick($event); dismissHint('spotlight')"
      ></canvas>
      <div
        class="spotlight-hint"
        x-show="mode === 'spotlight' && showModeControl && !spotlightHintDismissed"
        x-cloak
        x-transition:enter="hint-enter"
        x-transition:enter-start="hint-enter-start"
        x-transition:enter-end="hint-enter-end"
        x-transition:leave="hint-leave"
        x-transition:leave-start="hint-leave-start"
        x-transition:leave-end="hint-leave-end"
      >
        <span class="hint-icon">+</span>
        <span class="hint-text">Click anywhere to set focus point</span>
      </div>
      <div class="canvas-toolbar" x-show="!isFullscreen" x-cloak>
        <button
          class="toolbar-btn fullscreen-btn"
          x-show="showFullscreenButton"
          x-cloak
          @click="toggleFullscreen"
          :title="isFullscreen ? 'Exit Fullscreen (Esc)' : 'Enter Fullscreen'"
        >
          <svg width="24" height="24"><use href="#icon-fullscreen" /></svg>
        </button>
        <div
          class="toolbar-btn-wrapper"
          x-show="showWidthControl || showOpszControl || showMinWeightControl || showMaxWeightControl || showStaticWeightControl"
          x-cloak
        >
          <button
            class="toolbar-btn typography-btn"
            @click="toggleTypographyPopover(); dismissHint('toolbar')"
            :class="{ 'active': typographyPopoverOpen }"
            title="Typography Options"
          >
            <svg width="24" height="24"><use href="#icon-typography" /></svg>
          </button>
          <div
            class="settings-popover glass-surface"
            x-show="typographyPopoverOpen"
            x-cloak
            x-transition:enter="popover-enter"
            x-transition:enter-start="popover-enter-start"
            x-transition:enter-end="popover-enter-end"
            x-transition:leave="popover-leave"
            x-transition:leave-start="popover-leave-start"
            x-transition:leave-end="popover-leave-end"
            @click.outside="closeTypographyPopover"
          >
            <div class="popover-header">Typography</div>
            <div class="control-group" x-show="showWidthControl">
              <label>Font Width</label>
              <div class="control-base-default">
                <input type="range" min="50" max="160" step="1" x-model.number="widthValue" />
                <span class="value-display" x-text="widthDisplay"></span>
              </div>
            </div>
            <div class="control-group" x-show="showOpszControl">
              <label>Ascenders & Descenders</label>
              <div class="control-base-default">
                <input type="range" min="8" max="140" step="1" x-model.number="opszValue" />
                <span class="value-display" x-text="opszDisplay"></span>
              </div>
            </div>
            <div class="control-group" x-show="showMinWeightControl">
              <label>Min Weight</label>
              <div class="control-base-default">
                <input type="range" min="10" max="100" step="1" x-model.number="minWeight" />
                <span class="value-display" x-text="minWeightDisplay"></span>
              </div>
            </div>
            <div class="control-group" x-show="showMaxWeightControl">
              <label>Max Weight</label>
              <div class="control-base-default">
                <input type="range" min="10" max="100" step="1" x-model.number="maxWeight" />
                <span class="value-display" x-text="maxWeightDisplay"></span>
              </div>
            </div>
            <div class="control-group" x-show="showStaticWeightControl">
              <label>Weight</label>
              <div class="control-base-default">
                <input type="range" min="10" max="100" step="1" x-model.number="staticWeight" />
                <span class="value-display" x-text="staticWeightDisplay"></span>
              </div>
            </div>
          </div>
        </div>
        <div class="toolbar-btn-wrapper" x-show="showSpeedControl || showModeControl" x-cloak>
          <button
            class="toolbar-btn animation-btn"
            @click="toggleAnimationPopover(); dismissHint('toolbar')"
            :class="{ 'active': animationPopoverOpen }"
            title="Animation Options"
          >
            <svg width="24" height="24"><use href="#icon-animation" /></svg>
          </button>
          <div
            class="settings-popover glass-surface"
            x-show="animationPopoverOpen"
            x-cloak
            x-transition:enter="popover-enter"
            x-transition:enter-start="popover-enter-start"
            x-transition:enter-end="popover-enter-end"
            x-transition:leave="popover-leave"
            x-transition:leave-start="popover-leave-start"
            x-transition:leave-end="popover-leave-end"
            @click.outside="closeAnimationPopover"
          >
            <div class="popover-header">Animation</div>
            <div class="control-group" x-show="showSpeedControl">
              <label>Speed</label>
              <div class="control-base-default">
                <input type="range" min="0.3" max="3" step="0.1" x-model.number="animationSpeed" />
                <span class="value-display" x-text="speedDisplay"></span>
              </div>
            </div>
            <div class="control-group" x-show="showModeControl">
              <label>Mode</label>
              <select x-model="mode" class="control-base">
                <template x-for="m in availableAnimationModes" :key="m.value">
                  <option :value="m.value" x-text="m.label"></option>
                </template>
              </select>
            </div>
          </div>
        </div>
        <button
          class="toolbar-btn download-btn mobile-only"
          @click="toggleDownloadPopover"
          :class="{ 'active': downloadPopoverOpen }"
          title="Download"
        >
          <svg width="24" height="24"><use href="#icon-download" /></svg>
        </button>
        <div class="toolbar-btn-wrapper">
          <button
            class="toolbar-btn share-btn"
            @click="toggleShareMenu"
            :class="{ 'active': shareMenuOpen }"
            :title="gallerySaveText || 'Share & Save'"
          >
            <span
              class="share-btn-text"
              x-show="gallerySaveText"
              x-text="gallerySaveText"
              x-cloak
            ></span>
            <svg x-show="!gallerySaveText" width="24" height="24"><use href="#icon-share" /></svg>
          </button>
          <div
            class="share-menu glass-surface"
            x-show="shareMenuOpen"
            x-cloak
            x-transition:enter="popover-enter"
            x-transition:enter-start="popover-enter-start"
            x-transition:enter-end="popover-enter-end"
            x-transition:leave="popover-leave"
            x-transition:leave-start="popover-leave-start"
            x-transition:leave-end="popover-leave-end"
            @click.outside="closeShareMenu"
          >
            <button class="share-menu-item" @click="handleShare">
              <svg width="20" height="20"><use href="#icon-link" /></svg>
              <span>Copy Link</span>
            </button>
            <button class="share-menu-item" x-show="showGallerySave" @click="saveCurrentToGallery">
              <svg width="20" height="20"><use href="#icon-bookmark" /></svg>
              <span>Save to My Gallery</span>
            </button>
          </div>
        </div>
        <button
          class="toolbar-btn gallery-btn"
          @click="toggleGallery"
          :class="{ 'active': galleryOpen }"
          title="My Gallery"
        >
          <svg width="24" height="24"><use href="#icon-gallery" /></svg>
        </button>
      </div>
      <div
        class="toolbar-hint"
        x-show="!toolbarHintDismissed && (showWidthControl || showOpszControl || showSpeedControl || showModeControl)"
        x-cloak
        x-transition:enter="toolbar-hint-enter"
        x-transition:enter-start="toolbar-hint-enter-start"
        x-transition:enter-end="toolbar-hint-enter-end"
        x-transition:leave="toolbar-hint-leave"
        x-transition:leave-start="toolbar-hint-leave-start"
        x-transition:leave-end="toolbar-hint-leave-end"
      >
        <span class="toolbar-hint-arrow"></span>
        <span class="toolbar-hint-text">More Options!</span>
      </div>
      <div class="stats" id="stats">
        FPS: <span x-text="fps">0</span>
        <a
          href="https://github.com/o1y/39c3-artwork-generator"
          target="_blank"
          rel="noopener noreferrer"
        >
          View source
        </a>
      </div>
    </div>

    <div class="footer-bar glass-surface" x-show="showFooter" x-cloak>
      <div class="footer-section footer-toolbar">
        <button
          class="toolbar-btn typography-btn"
          x-show="showWidthControl || showOpszControl || showMinWeightControl || showMaxWeightControl || showStaticWeightControl"
          x-cloak
          @click="toggleTypographyPopover"
          :class="{ 'active': typographyPopoverOpen }"
          title="Typography Options"
        >
          <svg width="24" height="24"><use href="#icon-typography" /></svg>
        </button>
        <button
          class="toolbar-btn animation-btn"
          x-show="showSpeedControl || showModeControl"
          x-cloak
          @click="toggleAnimationPopover"
          :class="{ 'active': animationPopoverOpen }"
          title="Animation Options"
        >
          <svg width="24" height="24"><use href="#icon-animation" /></svg>
        </button>
        <button
          class="toolbar-btn download-btn"
          @click="toggleDownloadPopover"
          :class="{ 'active': downloadPopoverOpen }"
          title="Download"
        >
          <svg width="24" height="24"><use href="#icon-download" /></svg>
        </button>
        <div class="toolbar-btn-wrapper footer-share-wrapper">
          <button
            class="toolbar-btn share-btn"
            @click="toggleShareMenu"
            :class="{ 'active': shareMenuOpen }"
            :title="gallerySaveText || 'Share & Save'"
          >
            <span
              class="share-btn-text"
              x-show="gallerySaveText"
              x-text="gallerySaveText"
              x-cloak
            ></span>
            <svg x-show="!gallerySaveText" width="24" height="24"><use href="#icon-share" /></svg>
          </button>
          <div
            class="share-menu share-menu-bottom glass-surface"
            x-show="shareMenuOpen"
            x-cloak
            x-transition:enter="popover-enter"
            x-transition:enter-start="popover-enter-start"
            x-transition:enter-end="popover-enter-end"
            x-transition:leave="popover-leave"
            x-transition:leave-start="popover-leave-start"
            x-transition:leave-end="popover-leave-end"
            @click.outside="closeShareMenu"
          >
            <button class="share-menu-item" @click="handleShare">
              <svg width="20" height="20"><use href="#icon-link" /></svg>
              <span>Copy Link</span>
            </button>
            <button class="share-menu-item" x-show="showGallerySave" @click="saveCurrentToGallery">
              <svg width="20" height="20"><use href="#icon-bookmark" /></svg>
              <span>Save to My Gallery</span>
            </button>
          </div>
        </div>
        <button
          class="toolbar-btn gallery-btn"
          @click="toggleGallery"
          :class="{ 'active': galleryOpen }"
          title="My Gallery"
        >
          <svg width="24" height="24"><use href="#icon-gallery" /></svg>
        </button>
      </div>

      <div class="footer-section footer-animation" x-show="showAnimationControls" x-cloak>
        <button
          class="btn-primary btn-base play-pause-btn"
          @click="togglePlayPause"
          x-text="playPauseLabel"
        ></button>
        <div class="frame-slider-group">
          <input
            type="range"
            min="0"
            :max="maxFrames - 1"
            step="1"
            x-model.number="currentFrame"
            @input="onFrameSliderInput"
            class="frame-slider"
          />
          <div class="frame-display-row">
            <span class="frame-number" x-text="frameDisplay"></span>
          </div>
        </div>
      </div>

      <div class="footer-section footer-export" x-show="showExportControls" x-cloak>
        <div class="control-group" x-show="showDurationControl" x-cloak>
          <label>Duration</label>
          <select x-model="exportLoops" class="control-base">
            <template x-for="duration in availableDurations" :key="duration.value">
              <option :value="duration.value" x-text="duration.label"></option>
            </template>
          </select>
        </div>
        <div class="control-group" x-show="showResolutionControl" x-cloak>
          <label>Resolution</label>
          <select x-model="exportResolution" class="control-base">
            <template x-for="res in availableResolutions" :key="res.value">
              <option :value="res.value" x-text="res.label"></option>
            </template>
          </select>
        </div>
        <div class="control-group">
          <label>Format</label>
          <select x-model="exportFormat" class="control-base">
            <template x-for="fmt in availableExportFormats" :key="fmt.value">
              <option :value="fmt.value" x-text="fmt.label" :disabled="fmt.disabled"></option>
            </template>
          </select>
        </div>
        <button
          class="btn-primary btn-base export-btn"
          @click="handleDownload"
          :disabled="isExporting"
          x-text="downloadButtonText"
        ></button>
      </div>
    </div>

    <div
      class="bottom-sheet-backdrop"
      x-show="typographyPopoverOpen"
      x-cloak
      x-transition:enter="sheet-backdrop-enter"
      x-transition:enter-start="sheet-backdrop-enter-start"
      x-transition:enter-end="sheet-backdrop-enter-end"
      x-transition:leave="sheet-backdrop-leave"
      x-transition:leave-start="sheet-backdrop-leave-start"
      x-transition:leave-end="sheet-backdrop-leave-end"
      @click="closeTypographyPopover"
      :class="{ 'see-through': isSliderDragging }"
    ></div>
    <div
      class="bottom-sheet"
      x-show="typographyPopoverOpen"
      x-cloak
      x-transition:enter="sheet-enter"
      x-transition:enter-start="sheet-enter-start"
      x-transition:enter-end="sheet-enter-end"
      x-transition:leave="sheet-leave"
      x-transition:leave-start="sheet-leave-start"
      x-transition:leave-end="sheet-leave-end"
      :class="{ 'see-through': isSliderDragging }"
    >
      <div class="bottom-sheet-header">
        <span class="bottom-sheet-title">Typography</span>
        <button class="bottom-sheet-close" @click="closeTypographyPopover" aria-label="Close">
          <svg width="16" height="16"><use href="#icon-close" /></svg>
        </button>
      </div>
      <div class="control-group" x-show="showWidthControl">
        <label>Font Width</label>
        <div class="control-base-default">
          <input
            type="range"
            min="50"
            max="160"
            step="1"
            x-model.number="widthValue"
            @touchstart="isSliderDragging = true"
            @touchend="isSliderDragging = false"
            @touchcancel="isSliderDragging = false"
          />
          <span class="value-display" x-text="widthDisplay"></span>
        </div>
      </div>
      <div class="control-group" x-show="showOpszControl">
        <label>Ascenders & Descenders</label>
        <div class="control-base-default">
          <input
            type="range"
            min="8"
            max="140"
            step="1"
            x-model.number="opszValue"
            @touchstart="isSliderDragging = true"
            @touchend="isSliderDragging = false"
            @touchcancel="isSliderDragging = false"
          />
          <span class="value-display" x-text="opszDisplay"></span>
        </div>
      </div>
      <div class="control-group" x-show="showMinWeightControl">
        <label>Min Weight</label>
        <div class="control-base-default">
          <input
            type="range"
            min="10"
            max="100"
            step="1"
            x-model.number="minWeight"
            @touchstart="isSliderDragging = true"
            @touchend="isSliderDragging = false"
            @touchcancel="isSliderDragging = false"
          />
          <span class="value-display" x-text="minWeightDisplay"></span>
        </div>
      </div>
      <div class="control-group" x-show="showMaxWeightControl">
        <label>Max Weight</label>
        <div class="control-base-default">
          <input
            type="range"
            min="10"
            max="100"
            step="1"
            x-model.number="maxWeight"
            @touchstart="isSliderDragging = true"
            @touchend="isSliderDragging = false"
            @touchcancel="isSliderDragging = false"
          />
          <span class="value-display" x-text="maxWeightDisplay"></span>
        </div>
      </div>
      <div class="control-group" x-show="showStaticWeightControl">
        <label>Weight</label>
        <div class="control-base-default">
          <input
            type="range"
            min="10"
            max="100"
            step="1"
            x-model.number="staticWeight"
            @touchstart="isSliderDragging = true"
            @touchend="isSliderDragging = false"
            @touchcancel="isSliderDragging = false"
          />
          <span class="value-display" x-text="staticWeightDisplay"></span>
        </div>
      </div>
    </div>

    <div
      class="bottom-sheet-backdrop"
      x-show="animationPopoverOpen"
      x-cloak
      x-transition:enter="sheet-backdrop-enter"
      x-transition:enter-start="sheet-backdrop-enter-start"
      x-transition:enter-end="sheet-backdrop-enter-end"
      x-transition:leave="sheet-backdrop-leave"
      x-transition:leave-start="sheet-backdrop-leave-start"
      x-transition:leave-end="sheet-backdrop-leave-end"
      @click="closeAnimationPopover"
      :class="{ 'see-through': isSliderDragging }"
    ></div>
    <div
      class="bottom-sheet"
      x-show="animationPopoverOpen"
      x-cloak
      x-transition:enter="sheet-enter"
      x-transition:enter-start="sheet-enter-start"
      x-transition:enter-end="sheet-enter-end"
      x-transition:leave="sheet-leave"
      x-transition:leave-start="sheet-leave-start"
      x-transition:leave-end="sheet-leave-end"
      :class="{ 'see-through': isSliderDragging }"
    >
      <div class="bottom-sheet-header">
        <span class="bottom-sheet-title">Animation</span>
        <button class="bottom-sheet-close" @click="closeAnimationPopover" aria-label="Close">
          <svg width="16" height="16"><use href="#icon-close" /></svg>
        </button>
      </div>
      <div class="control-group" x-show="showSpeedControl">
        <label>Speed</label>
        <div class="control-base-default">
          <input
            type="range"
            min="0.3"
            max="3"
            step="0.1"
            x-model.number="animationSpeed"
            @touchstart="isSliderDragging = true"
            @touchend="isSliderDragging = false"
            @touchcancel="isSliderDragging = false"
          />
          <span class="value-display" x-text="speedDisplay"></span>
        </div>
      </div>
      <div class="control-group" x-show="showModeControl">
        <label>Mode</label>
        <select x-model="mode" class="control-base">
          <template x-for="m in availableAnimationModes" :key="m.value">
            <option :value="m.value" x-text="m.label"></option>
          </template>
        </select>
      </div>
    </div>

    <div
      class="bottom-sheet-backdrop"
      x-show="downloadPopoverOpen"
      x-cloak
      x-transition:enter="sheet-backdrop-enter"
      x-transition:enter-start="sheet-backdrop-enter-start"
      x-transition:enter-end="sheet-backdrop-enter-end"
      x-transition:leave="sheet-backdrop-leave"
      x-transition:leave-start="sheet-backdrop-leave-start"
      x-transition:leave-end="sheet-backdrop-leave-end"
      @click="closeDownloadPopover"
    ></div>
    <div
      class="bottom-sheet"
      x-show="downloadPopoverOpen"
      x-cloak
      x-transition:enter="sheet-enter"
      x-transition:enter-start="sheet-enter-start"
      x-transition:enter-end="sheet-enter-end"
      x-transition:leave="sheet-leave"
      x-transition:leave-start="sheet-leave-start"
      x-transition:leave-end="sheet-leave-end"
    >
      <div class="bottom-sheet-header">
        <span class="bottom-sheet-title">Download</span>
        <button class="bottom-sheet-close" @click="closeDownloadPopover" aria-label="Close">
          <svg width="16" height="16"><use href="#icon-close" /></svg>
        </button>
      </div>
      <div class="control-group" x-show="showDurationControl">
        <label>Duration</label>
        <select x-model="exportLoops" class="control-base">
          <template x-for="duration in availableDurations" :key="duration.value">
            <option :value="duration.value" x-text="duration.label"></option>
          </template>
        </select>
      </div>
      <div class="control-group" x-show="showResolutionControl">
        <label>Resolution</label>
        <select x-model="exportResolution" class="control-base">
          <template x-for="res in availableResolutions" :key="res.value">
            <option :value="res.value" x-text="res.label"></option>
          </template>
        </select>
      </div>
      <div class="control-group">
        <label>Format</label>
        <select x-model="exportFormat" class="control-base">
          <template x-for="fmt in availableExportFormats" :key="fmt.value">
            <option :value="fmt.value" x-text="fmt.label" :disabled="fmt.disabled"></option>
          </template>
        </select>
      </div>
      <button
        class="btn-primary btn-base export-btn"
        @click="handleDownload"
        :disabled="isExporting"
        x-text="downloadButtonText"
      ></button>
    </div>

    <!-- Gallery Panel -->
    <div
      class="gallery-backdrop"
      x-show="galleryOpen"
      x-cloak
      x-transition:enter="sheet-backdrop-enter"
      x-transition:enter-start="sheet-backdrop-enter-start"
      x-transition:enter-end="sheet-backdrop-enter-end"
      x-transition:leave="sheet-backdrop-leave"
      x-transition:leave-start="sheet-backdrop-leave-start"
      x-transition:leave-end="sheet-backdrop-leave-end"
      @click="closeGallery"
    ></div>
    <div
      class="gallery-panel"
      x-show="galleryOpen"
      x-cloak
      x-transition:enter="gallery-enter"
      x-transition:enter-start="gallery-enter-start"
      x-transition:enter-end="gallery-enter-end"
      x-transition:leave="gallery-leave"
      x-transition:leave-start="gallery-leave-start"
      x-transition:leave-end="gallery-leave-end"
    >
      <div class="gallery-header">
        <span class="gallery-title">My Gallery</span>
        <span class="gallery-count" x-text="galleryItems.length + ' saved'"></span>
        <button class="gallery-close" @click="closeGallery" aria-label="Close">
          <svg width="16" height="16"><use href="#icon-close" /></svg>
        </button>
      </div>
      <div class="gallery-grid" x-show="galleryItems.length > 0">
        <template x-for="item in galleryItems" :key="item.id">
          <div
            class="gallery-item"
            @click="loadFromGallery(item.id)"
            @mouseenter="startGalleryPreview(item, $event.currentTarget.querySelector('.gallery-preview-canvas'))"
            @mouseleave="stopGalleryPreview()"
          >
            <img class="gallery-thumbnail" :src="item.thumbnail" alt="Saved artwork" />
            <canvas
              class="gallery-preview-canvas"
              width="200"
              height="200"
              x-show="hoveredGalleryItem === item.id"
            ></canvas>
            <button
              class="gallery-delete"
              @click.stop="removeFromGallery(item.id)"
              title="Delete"
              aria-label="Delete artwork"
            >
              <svg width="12" height="12"><use href="#icon-close" /></svg>
            </button>
          </div>
        </template>
      </div>
      <div class="gallery-empty" x-show="galleryItems.length === 0">
        <svg class="gallery-empty-icon" width="48" height="48"><use href="#icon-gallery" /></svg>
        <p class="gallery-empty-title">No cycles stored</p>
        <p class="gallery-empty-hint">Persist your first power cycle via the Share menu</p>
      </div>
    </div>

    <script type="module" src="/app.js"></script>
  </body>
</html>
